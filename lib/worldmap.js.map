{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 6baa462c84de6176e37e","webpack:///./src/engine.js","webpack:///./src/vendor/CSS3DRenderer.js","webpack:///./src/vendor/TrackballControls.js","webpack:///./src/index.js"],"names":["planeWidth","planeHeight","Engine","options","console","log","scene","THREE","Scene","VIEW_ANGLE","ASPECT","window","innerWidth","innerHeight","NEAR","FAR","backgroundColor","camera","PerspectiveCamera","add","position","set","lookAt","renderer","CSS3DRenderer","setSize","domElement","style","document","getElementById","appendChild","controls","light","PointLight","createMap","imageMap","createElement","className","img","src","object","CSS3DObject","_animate","requestAnimationFrame","bind","render","update","TWEEN","element","latitude","longitude","get2DPosition","x","y","z","Object3D","call","WebkitTransformStyle","MozTransformStyle","oTransformStyle","transformStyle","addEventListener","event","parentNode","removeChild","i","l","children","length","dispatchEvent","prototype","Object","create","CSS3DSprite","REVISION","_width","_height","_widthHalf","_heightHalf","matrix","Matrix4","overflow","cameraElement","width","height","epsilon","value","Math","abs","getCameraCSSMatrix","elements","getObjectCSSMatrix","renderObject","copy","matrixWorldInverse","transpose","copyPosition","matrixWorld","scale","WebkitTransform","MozTransform","oTransform","transform","fov","tan","degToRad","WebkitPerspective","MozPerspective","oPerspective","perspective","updateMatrixWorld","parent","undefined","getInverse","TrackballControls","_this","STATE","NONE","ROTATE","ZOOM","PAN","TOUCH_ROTATE","TOUCH_ZOOM","TOUCH_PAN","enabled","screen","left","top","rotateSpeed","zoomSpeed","panSpeed","noRotate","noZoom","noPan","noRoll","staticMoving","dynamicDampingFactor","minDistance","maxDistance","Infinity","keys","target","Vector3","lastPosition","_state","_prevState","_eye","_rotateStart","_rotateEnd","_zoomStart","Vector2","_zoomEnd","_touchZoomDistanceStart","_touchZoomDistanceEnd","_panStart","_panEnd","target0","clone","position0","up0","up","changeEvent","type","handleResize","getBoundingClientRect","handleEvent","getMouseOnScreen","clientX","clientY","getMouseProjectionOnBall","mouseOnBall","SQRT1_2","sqrt","normalize","sub","projection","setLength","cross","rotateCamera","angle","acos","dot","axis","crossVectors","quaternion","Quaternion","setFromAxisAngle","applyQuaternion","zoomCamera","factor","multiplyScalar","panCamera","mouseChange","lengthSq","pan","subVectors","checkDistances","addVectors","distanceToSquared","reset","keydown","removeEventListener","keyCode","keyup","mousedown","preventDefault","stopPropagation","button","mousemove","mouseup","mousewheel","delta","wheelDelta","detail","touchstart","touches","pageX","pageY","dx","dy","touchmove","touchend","EventDispatcher","module","exports","_name","_engine","run","addElementAtPosition"],"mappings":"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","file":"worldmap.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"worldmap\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"worldmap\"] = factory();\n\telse\n\t\troot[\"worldmap\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6baa462c84de6176e37e","import TrackballControls from './vendor/TrackballControls';\r\nimport CSS3DRenderer from './vendor/CSS3DRenderer';\r\n\r\nconst planeWidth = 3312;\r\nconst planeHeight = 1634;\r\n\r\nexport default class Engine {\r\n\r\n  constructor(options) {\r\n\r\n    console.log('Create Engine');\r\n\r\n    // SCENE\r\n    this.scene = new THREE.Scene();\r\n\r\n    // CAMERA\r\n    const VIEW_ANGLE = 45, ASPECT = window.innerWidth / window.innerHeight, NEAR = 0.1, FAR = 20000;\r\n    const backgroundColor = options.backgroundColor ? options.backgroundColor : 0xffffff;\r\n\r\n    this.camera = new THREE.PerspectiveCamera(VIEW_ANGLE, ASPECT, NEAR, FAR);\r\n\r\n    this.scene.add(this.camera);\r\n    this.camera.position.set(0, -801, 1804);\r\n\r\n    this.camera.lookAt(this.scene.position);\r\n\r\n    this.renderer = new THREE.CSS3DRenderer();\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n    this.renderer.domElement.style.position = 'absolute';\r\n    document.getElementById('worldmap').appendChild(this.renderer.domElement);\r\n\r\n    // CONTROLS\r\n    this.controls = new TrackballControls(this.camera, this.renderer.domElement);\r\n\r\n    // LIGHT\r\n    let light = new THREE.PointLight(0xffffff);\r\n\r\n    light.position.set(0, 250, 0);\r\n    this.scene.add(light);\r\n\r\n    this.createMap();\r\n\r\n  }\r\n\r\n  createMap() {\r\n    let imageMap = document.createElement('div');\r\n    imageMap.className = 'img-map';\r\n    let img = document.createElement('img');\r\n    img.src = 'https://rawgit.com/goffle/worldmap/master/images/map.jpg';\r\n    imageMap.appendChild(img);\r\n\r\n    let object = new THREE.CSS3DObject(imageMap);\r\n\r\n    this.scene.add(object);\r\n\r\n  }\r\n\r\n  getCamera() { return this.camera; }\r\n  getRenderer() { return this.renderer; }\r\n\r\n  run() { this._animate(); }\r\n\r\n  _animate() {\r\n    requestAnimationFrame(this._animate.bind(this));\r\n\r\n    this.renderer.render(this.scene, this.camera);\r\n    this.controls.update();\r\n    TWEEN.update();\r\n  }\r\n\r\n  addElementAtPosition(element, latitude, longitude) {\r\n    let position = this.get2DPosition(latitude, longitude);\r\n    let object = new THREE.CSS3DObject(element);\r\n\r\n    object.position.x = position.x;\r\n    object.position.y = position.y;\r\n    object.position.z = 50;\r\n\r\n    object.lookAt( {x:position.x,y:position.y-400,z:1000});\r\n\r\n    this.scene.add(object);\r\n\r\n  }\r\n\r\n\r\n  get2DPosition(latitude, longitude) {\r\n    // No need for precision for theses level of details. Linear tranformation is enough\r\n    let x = ((planeWidth / 330.0) * (180 + longitude)) - planeWidth / 2 - 360;\r\n    let y = -((planeHeight / 138.0) * (90 - latitude)) + planeHeight / 2 + 120;\r\n\r\n    return { x, y };\r\n  }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/engine.js","/**\r\n * Based on http://www.emagix.net/academic/mscs-project/item/camera-sync-with-css3-and-webgl-threejs\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\n/* eslint-disable */\r\n\r\nTHREE.CSS3DObject = function ( element ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.element = element;\r\n\tthis.element.style.position = 'absolute';\r\n\tthis.element.style.WebkitTransformStyle = 'preserve-3d';\r\n\tthis.element.style.MozTransformStyle = 'preserve-3d';\r\n\tthis.element.style.oTransformStyle = 'preserve-3d';\r\n\tthis.element.style.transformStyle = 'preserve-3d';\r\n\r\n\tthis.addEventListener( 'removed', function ( event ) {\r\n\r\n\t\tif ( this.element.parentNode !== null ) {\r\n\r\n\t\t\tthis.element.parentNode.removeChild( this.element );\r\n\r\n\t\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.children[ i ].dispatchEvent( event );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n};\r\n\r\nTHREE.CSS3DObject.prototype = Object.create( THREE.Object3D.prototype );\r\n\r\nTHREE.CSS3DSprite = function ( element ) {\r\n\r\n\tTHREE.CSS3DObject.call( this, element );\r\n\r\n};\r\n\r\nTHREE.CSS3DSprite.prototype = Object.create( THREE.CSS3DObject.prototype );\r\n\r\n//\r\n\r\nTHREE.CSS3DRenderer = function () {\r\n\r\n\tconsole.log( 'THREE.CSS3DRenderer', THREE.REVISION );\r\n\r\n\tvar _width, _height;\r\n\tvar _widthHalf, _heightHalf;\r\n\r\n\tvar matrix = new THREE.Matrix4();\r\n\r\n\tvar domElement = document.createElement( 'div' );\r\n\tdomElement.style.overflow = 'hidden';\r\n\r\n\tdomElement.style.WebkitTransformStyle = 'preserve-3d';\r\n\tdomElement.style.MozTransformStyle = 'preserve-3d';\r\n\tdomElement.style.oTransformStyle = 'preserve-3d';\r\n\tdomElement.style.transformStyle = 'preserve-3d';\r\n\r\n\tthis.domElement = domElement;\r\n\r\n\tvar cameraElement = document.createElement( 'div' );\r\n\r\n\tcameraElement.style.WebkitTransformStyle = 'preserve-3d';\r\n\tcameraElement.style.MozTransformStyle = 'preserve-3d';\r\n\tcameraElement.style.oTransformStyle = 'preserve-3d';\r\n\tcameraElement.style.transformStyle = 'preserve-3d';\r\n\r\n\tdomElement.appendChild( cameraElement );\r\n\r\n\tthis.setSize = function ( width, height ) {\r\n\r\n\t\t_width = width;\r\n\t\t_height = height;\r\n\r\n\t\t_widthHalf = _width / 2;\r\n\t\t_heightHalf = _height / 2;\r\n\r\n\t\tdomElement.style.width = width + 'px';\r\n\t\tdomElement.style.height = height + 'px';\r\n\r\n\t\tcameraElement.style.width = width + 'px';\r\n\t\tcameraElement.style.height = height + 'px';\r\n\r\n\t};\r\n\r\n\tvar epsilon = function ( value ) {\r\n\r\n\t\treturn Math.abs( value ) < 0.000001 ? 0 : value;\r\n\r\n\t};\r\n\r\n\tvar getCameraCSSMatrix = function ( matrix ) {\r\n\r\n\t\tvar elements = matrix.elements;\r\n\r\n\t\treturn 'matrix3d(' +\r\n\t\t\tepsilon( elements[ 0 ] ) + ',' +\r\n\t\t\tepsilon( - elements[ 1 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 2 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 3 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 4 ] ) + ',' +\r\n\t\t\tepsilon( - elements[ 5 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 6 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 7 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 8 ] ) + ',' +\r\n\t\t\tepsilon( - elements[ 9 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 10 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 11 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 12 ] ) + ',' +\r\n\t\t\tepsilon( - elements[ 13 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 14 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 15 ] ) +\r\n\t\t')';\r\n\r\n\t};\r\n\r\n\tvar getObjectCSSMatrix = function ( matrix ) {\r\n\r\n\t\tvar elements = matrix.elements;\r\n\r\n\t\treturn 'translate3d(-50%,-50%,0) matrix3d(' +\r\n\t\t\tepsilon( elements[ 0 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 1 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 2 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 3 ] ) + ',' +\r\n\t\t\tepsilon( - elements[ 4 ] ) + ',' +\r\n\t\t\tepsilon( - elements[ 5 ] ) + ',' +\r\n\t\t\tepsilon( - elements[ 6 ] ) + ',' +\r\n\t\t\tepsilon( - elements[ 7 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 8 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 9 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 10 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 11 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 12 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 13 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 14 ] ) + ',' +\r\n\t\t\tepsilon( elements[ 15 ] ) +\r\n\t\t')';\r\n\r\n\t};\r\n\r\n\tvar renderObject = function ( object, camera ) {\r\n\r\n\t\tif ( object instanceof THREE.CSS3DObject ) {\r\n\r\n\t\t\tvar style;\r\n\r\n\t\t\tif ( object instanceof THREE.CSS3DSprite ) {\r\n\r\n\t\t\t\t// http://swiftcoder.wordpress.com/2008/11/25/constructing-a-billboard-matrix/\r\n\r\n\t\t\t\tmatrix.copy( camera.matrixWorldInverse );\r\n\t\t\t\tmatrix.transpose();\r\n\t\t\t\tmatrix.copyPosition( object.matrixWorld );\r\n\t\t\t\tmatrix.scale( object.scale );\r\n\r\n\t\t\t\tmatrix.elements[ 3 ] = 0;\r\n\t\t\t\tmatrix.elements[ 7 ] = 0;\r\n\t\t\t\tmatrix.elements[ 11 ] = 0;\r\n\t\t\t\tmatrix.elements[ 15 ] = 1;\r\n\r\n\t\t\t\tstyle = getObjectCSSMatrix( matrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstyle = getObjectCSSMatrix( object.matrixWorld );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar element = object.element;\r\n\r\n\t\t\telement.style.WebkitTransform = style;\r\n\t\t\telement.style.MozTransform = style;\r\n\t\t\telement.style.oTransform = style;\r\n\t\t\telement.style.transform = style;\r\n\r\n\t\t\tif ( element.parentNode !== cameraElement ) {\r\n\r\n\t\t\t\tcameraElement.appendChild( element );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, l = object.children.length; i < l; i ++ ) {\r\n\r\n\t\t\trenderObject( object.children[ i ], camera );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.render = function ( scene, camera ) {\r\n\r\n\t\tvar fov = 0.5 / Math.tan( THREE.Math.degToRad( camera.fov * 0.5 ) ) * _height;\r\n\r\n\t\tdomElement.style.WebkitPerspective = fov + \"px\";\r\n\t\tdomElement.style.MozPerspective = fov + \"px\";\r\n\t\tdomElement.style.oPerspective = fov + \"px\";\r\n\t\tdomElement.style.perspective = fov + \"px\";\r\n\r\n\t\tscene.updateMatrixWorld();\r\n\r\n\t\tif ( camera.parent === undefined ) camera.updateMatrixWorld();\r\n\r\n\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\r\n\r\n\t\tvar style = \"translate3d(0,0,\" + fov + \"px)\" + getCameraCSSMatrix( camera.matrixWorldInverse ) +\r\n\t\t\t\" translate3d(\" + _widthHalf + \"px,\" + _heightHalf + \"px, 0)\";\r\n\r\n\t\tcameraElement.style.WebkitTransform = style;\r\n\t\tcameraElement.style.MozTransform = style;\r\n\t\tcameraElement.style.oTransform = style;\r\n\t\tcameraElement.style.transform = style;\r\n\r\n\t\trenderObject( scene, camera );\r\n\r\n\t};\r\n\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/vendor/CSS3DRenderer.js","/**\r\n * @author Eberhard Graether / http://egraether.com/\r\n */\r\n\r\n/* eslint-disable */\r\n\r\nTHREE.TrackballControls = function ( object, domElement ) {\r\n\r\n\tvar _this = this;\r\n\tvar STATE = { NONE: -1, ROTATE: 0, ZOOM: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_ZOOM: 4, TOUCH_PAN: 5 };\r\n\r\n\tthis.object = object;\r\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\r\n\r\n\t// API\r\n\r\n\tthis.enabled = true;\r\n\r\n\tthis.screen = { left: 0, top: 0, width: 0, height: 0 };\r\n\r\n\tthis.rotateSpeed = 1.0;\r\n\tthis.zoomSpeed = 1.2;\r\n\tthis.panSpeed = 0.3;\r\n\r\n\tthis.noRotate = false;\r\n\tthis.noZoom = false;\r\n\tthis.noPan = false;\r\n\tthis.noRoll = false;\r\n\r\n\tthis.staticMoving = false;\r\n\tthis.dynamicDampingFactor = 0.2;\r\n\r\n\tthis.minDistance = 0;\r\n\tthis.maxDistance = Infinity;\r\n\r\n\tthis.keys = [ 65 /*A*/, 83 /*S*/, 68 /*D*/ ];\r\n\r\n\t// internals\r\n\r\n\tthis.target = new THREE.Vector3();\r\n\r\n\tvar lastPosition = new THREE.Vector3();\r\n\r\n\tvar _state = STATE.NONE,\r\n\t_prevState = STATE.NONE,\r\n\r\n\t_eye = new THREE.Vector3(),\r\n\r\n\t_rotateStart = new THREE.Vector3(),\r\n\t_rotateEnd = new THREE.Vector3(),\r\n\r\n\t_zoomStart = new THREE.Vector2(),\r\n\t_zoomEnd = new THREE.Vector2(),\r\n\r\n\t_touchZoomDistanceStart = 0,\r\n\t_touchZoomDistanceEnd = 0,\r\n\r\n\t_panStart = new THREE.Vector2(),\r\n\t_panEnd = new THREE.Vector2();\r\n\r\n\t// for reset\r\n\r\n\tthis.target0 = this.target.clone();\r\n\tthis.position0 = this.object.position.clone();\r\n\tthis.up0 = this.object.up.clone();\r\n\r\n\t// events\r\n\r\n\tvar changeEvent = { type: 'change' };\r\n\r\n\r\n\t// methods\r\n\r\n\tthis.handleResize = function () {\r\n\r\n\t\tif ( this.domElement === document ) {\r\n\r\n\t\t\tthis.screen.left = 0;\r\n\t\t\tthis.screen.top = 0;\r\n\t\t\tthis.screen.width = window.innerWidth;\r\n\t\t\tthis.screen.height = window.innerHeight;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.screen = this.domElement.getBoundingClientRect();\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.handleEvent = function ( event ) {\r\n\r\n\t\tif ( typeof this[ event.type ] == 'function' ) {\r\n\r\n\t\t\tthis[ event.type ]( event );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.getMouseOnScreen = function ( clientX, clientY ) {\r\n\r\n\t\treturn new THREE.Vector2(\r\n\t\t\t( clientX - _this.screen.left ) / _this.screen.width,\r\n\t\t\t( clientY - _this.screen.top ) / _this.screen.height\r\n\t\t);\r\n\r\n\t};\r\n\r\n\tthis.getMouseProjectionOnBall = function ( clientX, clientY ) {\r\n\r\n\t\tvar mouseOnBall = new THREE.Vector3(\r\n\t\t\t( clientX - _this.screen.width * 0.5 - _this.screen.left ) / (_this.screen.width*.5),\r\n\t\t\t( _this.screen.height * 0.5 + _this.screen.top - clientY ) / (_this.screen.height*.5),\r\n\t\t\t0.0\r\n\t\t);\r\n\r\n\t\tvar length = mouseOnBall.length();\r\n\r\n\t\tif ( _this.noRoll ) {\r\n\r\n\t\t\tif ( length < Math.SQRT1_2 ) {\r\n\r\n\t\t\t\tmouseOnBall.z = Math.sqrt( 1.0 - length*length );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmouseOnBall.z = .5 / length;\r\n\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t} else if ( length > 1.0 ) {\r\n\r\n\t\t\tmouseOnBall.normalize();\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmouseOnBall.z = Math.sqrt( 1.0 - length * length );\r\n\r\n\t\t}\r\n\r\n\t\t_eye.copy( _this.object.position ).sub( _this.target );\r\n\r\n\t\tvar projection = _this.object.up.clone().setLength( mouseOnBall.y );\r\n\t\tprojection.add( _this.object.up.clone().cross( _eye ).setLength( mouseOnBall.x ) );\r\n\t\tprojection.add( _eye.setLength( mouseOnBall.z ) );\r\n\r\n\t\treturn projection;\r\n\r\n\t};\r\n\r\n\tthis.rotateCamera = function () {\r\n\r\n\t\tvar angle = Math.acos( _rotateStart.dot( _rotateEnd ) / _rotateStart.length() / _rotateEnd.length() );\r\n\r\n\t\tif ( angle ) {\r\n\r\n\t\t\tvar axis = ( new THREE.Vector3() ).crossVectors( _rotateStart, _rotateEnd ).normalize(),\r\n\t\t\t\tquaternion = new THREE.Quaternion();\r\n\r\n\t\t\tangle *= _this.rotateSpeed;\r\n\r\n\t\t\tquaternion.setFromAxisAngle( axis, -angle );\r\n\r\n\t\t\t_eye.applyQuaternion( quaternion );\r\n\t\t\t_this.object.up.applyQuaternion( quaternion );\r\n\r\n\t\t\t_rotateEnd.applyQuaternion( quaternion );\r\n\r\n\t\t\tif ( _this.staticMoving ) {\r\n\r\n\t\t\t\t_rotateStart.copy( _rotateEnd );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tquaternion.setFromAxisAngle( axis, angle * ( _this.dynamicDampingFactor - 1.0 ) );\r\n\t\t\t\t_rotateStart.applyQuaternion( quaternion );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.zoomCamera = function () {\r\n\r\n\t\tif ( _state === STATE.TOUCH_ZOOM ) {\r\n\r\n\t\t\tvar factor = _touchZoomDistanceStart / _touchZoomDistanceEnd;\r\n\t\t\t_touchZoomDistanceStart = _touchZoomDistanceEnd;\r\n\t\t\t_eye.multiplyScalar( factor );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar factor = 1.0 + ( _zoomEnd.y - _zoomStart.y ) * _this.zoomSpeed;\r\n\r\n\t\t\tif ( factor !== 1.0 && factor > 0.0 ) {\r\n\r\n\t\t\t\t_eye.multiplyScalar( factor );\r\n\r\n\t\t\t\tif ( _this.staticMoving ) {\r\n\r\n\t\t\t\t\t_zoomStart.copy( _zoomEnd );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_zoomStart.y += ( _zoomEnd.y - _zoomStart.y ) * this.dynamicDampingFactor;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.panCamera = function () {\r\n\r\n\t\tvar mouseChange = _panEnd.clone().sub( _panStart );\r\n\r\n\t\tif ( mouseChange.lengthSq() ) {\r\n\r\n\t\t\tmouseChange.multiplyScalar( _eye.length() * _this.panSpeed );\r\n\r\n\t\t\tvar pan = _eye.clone().cross( _this.object.up ).setLength( mouseChange.x );\r\n\t\t\tpan.add( _this.object.up.clone().setLength( mouseChange.y ) );\r\n\r\n\t\t\t_this.object.position.add( pan );\r\n\t\t\t_this.target.add( pan );\r\n\r\n\t\t\tif ( _this.staticMoving ) {\r\n\r\n\t\t\t\t_panStart = _panEnd;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_panStart.add( mouseChange.subVectors( _panEnd, _panStart ).multiplyScalar( _this.dynamicDampingFactor ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.checkDistances = function () {\r\n\r\n\t\tif ( !_this.noZoom || !_this.noPan ) {\r\n\r\n\t\t\tif ( _eye.lengthSq() > _this.maxDistance * _this.maxDistance ) {\r\n\r\n\t\t\t\t_this.object.position.addVectors( _this.target, _eye.setLength( _this.maxDistance ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( _eye.lengthSq() < _this.minDistance * _this.minDistance ) {\r\n\r\n\t\t\t\t_this.object.position.addVectors( _this.target, _eye.setLength( _this.minDistance ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.update = function () {\r\n\r\n\t\t_eye.subVectors( _this.object.position, _this.target );\r\n\r\n\t\tif ( !_this.noRotate ) {\r\n\r\n\t\t\t_this.rotateCamera();\r\n\r\n\t\t}\r\n\r\n\t\tif ( !_this.noZoom ) {\r\n\r\n\t\t\t_this.zoomCamera();\r\n\r\n\t\t}\r\n\r\n\t\tif ( !_this.noPan ) {\r\n\r\n\t\t\t_this.panCamera();\r\n\r\n\t\t}\r\n\r\n\t\t_this.object.position.addVectors( _this.target, _eye );\r\n\r\n\t\t_this.checkDistances();\r\n\r\n\t\t_this.object.lookAt( _this.target );\r\n\r\n\t\tif ( lastPosition.distanceToSquared( _this.object.position ) > 0 ) {\r\n\r\n\t\t\t_this.dispatchEvent( changeEvent );\r\n\r\n\t\t\tlastPosition.copy( _this.object.position );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.reset = function () {\r\n\r\n\t\t_state = STATE.NONE;\r\n\t\t_prevState = STATE.NONE;\r\n\r\n\t\t_this.target.copy( _this.target0 );\r\n\t\t_this.object.position.copy( _this.position0 );\r\n\t\t_this.object.up.copy( _this.up0 );\r\n\r\n\t\t_eye.subVectors( _this.object.position, _this.target );\r\n\r\n\t\t_this.object.lookAt( _this.target );\r\n\r\n\t\t_this.dispatchEvent( changeEvent );\r\n\r\n\t\tlastPosition.copy( _this.object.position );\r\n\r\n\t};\r\n\r\n\t// listeners\r\n\r\n\tfunction keydown( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\twindow.removeEventListener( 'keydown', keydown );\r\n\r\n\t\t_prevState = _state;\r\n\r\n\t\tif ( _state !== STATE.NONE ) {\r\n\r\n\t\t\treturn;\r\n\r\n\t\t} else if ( event.keyCode === _this.keys[ STATE.ROTATE ] && !_this.noRotate ) {\r\n\r\n\t\t\t_state = STATE.ROTATE;\r\n\r\n\t\t} else if ( event.keyCode === _this.keys[ STATE.ZOOM ] && !_this.noZoom ) {\r\n\r\n\t\t\t_state = STATE.ZOOM;\r\n\r\n\t\t} else if ( event.keyCode === _this.keys[ STATE.PAN ] && !_this.noPan ) {\r\n\r\n\t\t\t_state = STATE.PAN;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction keyup( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\t_state = _prevState;\r\n\r\n\t\twindow.addEventListener( 'keydown', keydown, false );\r\n\r\n\t}\r\n\r\n\tfunction mousedown( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tif ( _state === STATE.NONE ) {\r\n\r\n\t\t\t_state = event.button;\r\n\r\n\t\t}\r\n\r\n\t\tif ( _state === STATE.ROTATE && !_this.noRotate ) {\r\n\r\n\t\t\t_rotateStart = _this.getMouseProjectionOnBall( event.clientX, event.clientY );\r\n\t\t\t_rotateEnd.copy(_rotateStart)\r\n\r\n\t\t} else if ( _state === STATE.ZOOM && !_this.noZoom ) {\r\n\r\n\t\t\t_zoomStart = _this.getMouseOnScreen( event.clientX, event.clientY );\r\n\t\t\t_zoomEnd.copy(_zoomStart);\r\n\r\n\t\t} else if ( _state === STATE.PAN && !_this.noPan ) {\r\n\r\n\t\t\t_panStart = _this.getMouseOnScreen( event.clientX, event.clientY );\r\n\t\t\t_panEnd.copy(_panStart)\r\n\r\n\t\t}\r\n\r\n\t\tdocument.addEventListener( 'mousemove', mousemove, false );\r\n\t\tdocument.addEventListener( 'mouseup', mouseup, false );\r\n\r\n\t}\r\n\r\n\tfunction mousemove( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tif ( _state === STATE.ROTATE && !_this.noRotate ) {\r\n\r\n\t\t\t_rotateEnd = _this.getMouseProjectionOnBall( event.clientX, event.clientY );\r\n\r\n\t\t} else if ( _state === STATE.ZOOM && !_this.noZoom ) {\r\n\r\n\t\t\t_zoomEnd = _this.getMouseOnScreen( event.clientX, event.clientY );\r\n\r\n\t\t} else if ( _state === STATE.PAN && !_this.noPan ) {\r\n\r\n\t\t\t_panEnd = _this.getMouseOnScreen( event.clientX, event.clientY );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction mouseup( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\t_state = STATE.NONE;\r\n\r\n\t\tdocument.removeEventListener( 'mousemove', mousemove );\r\n\t\tdocument.removeEventListener( 'mouseup', mouseup );\r\n\r\n\t}\r\n\r\n\tfunction mousewheel( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tvar delta = 0;\r\n\r\n\t\tif ( event.wheelDelta ) { // WebKit / Opera / Explorer 9\r\n\r\n\t\t\tdelta = event.wheelDelta / 40;\r\n\r\n\t\t} else if ( event.detail ) { // Firefox\r\n\r\n\t\t\tdelta = - event.detail / 3;\r\n\r\n\t\t}\r\n\r\n\t\t_zoomStart.y += delta * 0.01;\r\n\r\n\t}\r\n\r\n\tfunction touchstart( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tswitch ( event.touches.length ) {\r\n\r\n\t\t\tcase 1:\r\n\t\t\t\t_state = STATE.TOUCH_ROTATE;\r\n\t\t\t\t_rotateStart = _rotateEnd = _this.getMouseProjectionOnBall( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 2:\r\n\t\t\t\t_state = STATE.TOUCH_ZOOM;\r\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\r\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\r\n\t\t\t\t_touchZoomDistanceEnd = _touchZoomDistanceStart = Math.sqrt( dx * dx + dy * dy );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 3:\r\n\t\t\t\t_state = STATE.TOUCH_PAN;\r\n\t\t\t\t_panStart = _panEnd = _this.getMouseOnScreen( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\t_state = STATE.NONE;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction touchmove( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tswitch ( event.touches.length ) {\r\n\r\n\t\t\tcase 1:\r\n\t\t\t\t_rotateEnd = _this.getMouseProjectionOnBall( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 2:\r\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\r\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\r\n\t\t\t\t_touchZoomDistanceEnd = Math.sqrt( dx * dx + dy * dy )\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 3:\r\n\t\t\t\t_panEnd = _this.getMouseOnScreen( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\t_state = STATE.NONE;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction touchend( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tswitch ( event.touches.length ) {\r\n\r\n\t\t\tcase 1:\r\n\t\t\t\t_rotateStart = _rotateEnd = _this.getMouseProjectionOnBall( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 2:\r\n\t\t\t\t_touchZoomDistanceStart = _touchZoomDistanceEnd = 0;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 3:\r\n\t\t\t\t_panStart = _panEnd = _this.getMouseOnScreen( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\t_state = STATE.NONE;\r\n\r\n\t}\r\n\r\n\tthis.domElement.addEventListener( 'contextmenu', function ( event ) { event.preventDefault(); }, false );\r\n\r\n\tthis.domElement.addEventListener( 'mousedown', mousedown, false );\r\n\r\n\tthis.domElement.addEventListener( 'mousewheel', mousewheel, false );\r\n\tthis.domElement.addEventListener( 'DOMMouseScroll', mousewheel, false ); // firefox\r\n\r\n\tthis.domElement.addEventListener( 'touchstart', touchstart, false );\r\n\tthis.domElement.addEventListener( 'touchend', touchend, false );\r\n\tthis.domElement.addEventListener( 'touchmove', touchmove, false );\r\n\r\n\twindow.addEventListener( 'keydown', keydown, false );\r\n\twindow.addEventListener( 'keyup', keyup, false );\r\n\r\n\tthis.handleResize();\r\n\r\n};\r\n\r\nTHREE.TrackballControls.prototype = Object.create( THREE.EventDispatcher.prototype );\r\n\r\nexport default THREE.TrackballControls;\n\n\n// WEBPACK FOOTER //\n// ./src/vendor/TrackballControls.js","import Engine from './engine';\r\n\r\nmodule.exports = class worldmap {\r\n  constructor(options = {}) {\r\n    this._name = 'worldmap';\r\n    this._engine = new Engine(options);\r\n\r\n    this._engine.run();\r\n  }\r\n  get name() {\r\n    return this._name;\r\n  }\r\n  \r\n  addElementAtPosition(element,latitude, longitude) {\r\n    this._engine.addElementAtPosition(element,latitude, longitude);\r\n  }\r\n\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}